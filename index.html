<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>YouBike 站點時序地圖</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <header class="app__header">
      <h1>YouBike 時間軸地圖</h1>
      <p>拖曳時間軸查看各時段的車輛數量。CSV 檔案放在 <code>csv/</code> 資料夾並更新 <code>manifest.json</code> 即可加入新的日期。</p>
    </header>
    <main class="app__main">
      <div id="map" aria-label="YouBike 地圖"></div>
      <div class="timeline" id="timeline">
        <div class="timeline__label" id="timeline-label">載入資料中…</div>
        <input type="range" id="time-slider" min="0" max="0" value="0" step="1" disabled>
        <div class="timeline__meta">
          <button id="play-toggle" class="control-button" type="button" aria-label="自動播放">▶ 自動播放</button>
          <button id="view-toggle" class="control-button" type="button" aria-label="切換視角">切換為 2D</button>
          <label class="scale-control" for="height-scale">柱高倍率
            <input type="range" id="height-scale" min="2" max="100" step="1" value="6" aria-valuemin="2" aria-valuemax="100" aria-valuenow="6">
            <span id="height-scale-value">6×</span>
          </label>
          <label class="speed-control" for="autoplay-speed">播放速度
            <input type="range" id="autoplay-speed" min="0.5" max="5" step="0.1" value="1.5" aria-valuemin="0.5" aria-valuemax="5" aria-valuenow="1.5">
            <span id="autoplay-speed-value">1.5 秒</span>
          </label>
          <label class="mode-control" for="mode-select">顯示模式
            <select id="mode-select" aria-label="選擇顯示模式">
              <option value="raw" selected>即時車量</option>
              <option value="delta">十分鐘變化量</option>
              <option value="cumulative">當日累積變化</option>
            </select>
          </label>
          <select id="date-select" aria-label="選擇日期"></select>
          <div class="legend">
            <span class="legend__item"><span class="legend__dot legend__dot--low"></span><span class="legend__text" id="legend-label-low">低車量</span></span>
            <span class="legend__item"><span class="legend__dot legend__dot--mid"></span><span class="legend__text" id="legend-label-mid">中等</span></span>
            <span class="legend__item"><span class="legend__dot legend__dot--high"></span><span class="legend__text" id="legend-label-high">高車量</span></span>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js"></script>
  <script src="main.js" type="module"></script>
</body>
</html>
